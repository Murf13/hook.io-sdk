#!/usr/local/bin/node
var sdk = require("../");
var config = require(__dirname + '/../config');
var hook_private_key = "";

var client = sdk.createClient({
  hook_private_key: hook_private_key,
  host: config.host,
  port: config.port,
  protocol: config.protocol
});

var argv = require('minimist')(process.argv.slice(2));
if (typeof argv._[0] === "undefined") {
  console.log('hook name is required!');
  process.exit();
  return;
}
// map incoming argv flags / data as params to service
var params = {};
Object.keys(argv).forEach(function (k, v) {
  if (k !== "_") {
    params[k] = argv[k];
  }
});

// TODO: got owner of hook from somewhere
client.hook.run({ owner: 'david', name: argv._[0], data: params }, function (err, result) {
  if (err) {
    console.log(err)
    return;
  }
  console.log(result)
});